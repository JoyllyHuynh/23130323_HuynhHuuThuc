<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang Chia Sẻ Tài Liệu</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<header>
    <h1>Share Files</h1>
    <input type="text" id="searchInput" placeholder="Tìm kiếm..." onkeyup="filterFiles()">
</header>

<div class="container">
    <nav class="sidebar">
        <ul>
            <li>
                <a href="#" class="toggle" onclick="toggleFiles()">My Files</a>
                <ul class="sub-menu" id="myFiles">
                    <li><a href="#" onclick="showFiles('new')">New Files</a></li>
                    <li><a href="#" onclick="showFiles('shared')">Files</a></li>
                </ul>
            </li>
            <li><a href="#">Trash</a></li>
            <li><a href="#">Recent</a></li>
            <li><a href="#">Share with Me</a></li>
        </ul>
    </nav>
    <div class="content" id="fileContent">
        <h2>Các Tài Liệu Đang Chia Sẻ</h2>
    </div>
</div>

<div id="fileDetails" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2 id="fileName"></h2>
        <p><strong>Thời gian cập nhật gần nhất:</strong> <span id="lastUpdated"></span></p>
        <p><strong>Chủ sở hữu:</strong> <span id="owner"></span></p>
        
        <div id="relatedFiles" style="margin-top: 10px;">
            <strong>Các File Liên Quan:</strong>
            <ul id="relatedFileList"></ul>
        </div>

        <div class="file-content" id="fileContentDetails">
            <textarea id="editableContent" rows="4" style="width: 100%; display: none;"></textarea>
            <p id="nonEditableContent"></p>
        </div>
        <div class="button-container">
            <button onclick="editContent()">Sửa Nội Dung</button>
            <button onclick="saveContent()" style="display: none;" id="saveButton">Lưu Nội Dung</button>
        </div>
    </div>
</div>

<script>
    const fileDetails = {
        'File1.pdf': { 
            updated: '01/10/2024', 
            owner: 'Nguyễn Văn A', 
            content: 'Nội dung của File1.pdf...', 
            related: {
                'Bài giảng 1.pdf': { updated: '01/10/2024', owner: 'Nguyễn Văn A', content: 'Nội dung của Bài giảng 1.pdf...' },
                'Bài tập tham khảo 1.docx': { updated: '01/10/2024', owner: 'Nguyễn Văn A', content: 'Nội dung của Bài tập tham khảo 1.docx...' }
            }
        },
        'File2.docx': { 
            updated: '05/10/2024', 
            owner: 'Trần Thị B', 
            content: 'Nội dung của File2.docx...', 
            related: {
                'Bài giảng 2.pdf': { updated: '05/10/2024', owner: 'Trần Thị B', content: 'Nội dung của Bài giảng 2.pdf...' },
                'Bài tập tham khảo 2.docx': { updated: '05/10/2024', owner: 'Trần Thị B', content: 'Nội dung của Bài tập tham khảo 2.docx...' }
            }
        },
        'File3.pptx': { 
            updated: '10/10/2024', 
            owner: 'Lê Văn C', 
            content: 'Nội dung của File3.pptx...', 
            related: {
                'Bài giảng 3.pdf': { updated: '10/10/2024', owner: 'Lê Văn C', content: 'Nội dung của Bài giảng 3.pdf...' },
                'Bài tập tham khảo 3.docx': { updated: '10/10/2024', owner: 'Lê Văn C', content: 'Nội dung của Bài tập tham khảo 3.docx...' }
            }
        },
        // Thêm các file khác nếu cần
    };

    let currentFileName = '';

    function toggleFiles() {
        const myFilesMenu = document.getElementById('myFiles');
        myFilesMenu.classList.toggle('active');
    }

    function showFiles(type) {
        const fileContent = document.getElementById('fileContent');
        fileContent.innerHTML = `<h2>${type === 'new' ? 'Các File Mới' : 'Các File Được Chia Sẻ'}</h2>`;

        let files = type === 'new' 
            ? ['File1.pdf', 'File2.docx', 'File3.pptx'] 
            : ['SharedFile1.pdf', 'SharedFile2.docx', 'SharedFile3.pptx'];

        files.forEach(file => {
            fileContent.innerHTML += `<button class="file-button" onclick="showFileDetails('${file}')">${file}</button>`;
        });
    }

    function showFileDetails(fileName) {
        currentFileName = fileName; // Lưu tên file hiện tại
        const details = fileDetails[fileName];
        document.getElementById('fileName').innerText = fileName;
        document.getElementById('lastUpdated').innerText = details.updated;
        document.getElementById('owner').innerText = details.owner;

        // Hiển thị các file liên quan
        const relatedFileList = document.getElementById('relatedFileList');
        relatedFileList.innerHTML = ''; // Xóa nội dung cũ
        for (const relatedFile in details.related) {
            relatedFileList.innerHTML += `<li><button class="related-file-button" onclick="showRelatedFileDetails('${fileName}', '${relatedFile}')">${relatedFile}</button></li>`;
        }

        // Cập nhật nội dung
        document.getElementById('editableContent').style.display = 'none';
        document.getElementById('nonEditableContent').style.display = 'block';
        document.getElementById('nonEditableContent').innerText = details.content;

        const modal = document.getElementById('fileDetails');
        modal.style.display = 'block';
    }

    function showRelatedFileDetails(parentFileName, relatedFileName) {
        const relatedDetails = fileDetails[parentFileName].related[relatedFileName];
        document.getElementById('fileName').innerText = relatedFileName;
        document.getElementById('lastUpdated').innerText = relatedDetails.updated;
        document.getElementById('owner').innerText = relatedDetails.owner;

        // Hiển thị nội dung của file liên quan
        document.getElementById('editableContent').style.display = 'none';
        document.getElementById('nonEditableContent').style.display = 'block';
        document.getElementById('nonEditableContent').innerText = relatedDetails.content;

        const modal = document.getElementById('fileDetails');
        modal.style.display = 'block';
    }

    function closeModal() {
        const modal = document.getElementById('fileDetails');
        modal.style.display = 'none';
    }

    function editContent() {
        const details = fileDetails[currentFileName];
        document.getElementById('editableContent').style.display = 'block';
        document.getElementById('nonEditableContent').style.display = 'none';
        document.getElementById('editableContent').value = details.content; // Đưa nội dung vào ô nhập
        document.getElementById('saveButton').style.display = 'inline'; // Hiển thị nút Lưu
    }

    function saveContent() {
        const newContent = document.getElementById('editableContent').value;
        fileDetails[currentFileName].content = newContent; // Cập nhật nội dung file
        
        // Cập nhật thời gian
        const now = new Date();
        const updatedTime = `${now.getDate()}/${now.getMonth() + 1}/${now.getFullYear()} ${now.getHours()}:${now.getMinutes()}`;
        fileDetails[currentFileName].updated = updatedTime; // Cập nhật thời gian
        document.getElementById('lastUpdated').innerText = updatedTime; // Cập nhật hiển thị

        // Cập nhật nội dung hiển thị
        document.getElementById('nonEditableContent').innerText = newContent; // Cập nhật hiển thị
        document.getElementById('editableContent').style.display = 'none';
        document.getElementById('saveButton').style.display = 'none'; // Ẩn nút Lưu

        // Đóng modal sau khi lưu nội dung
        closeModal();
        
        // Hiện lại khung chi tiết file đã sửa
        showFileDetails(currentFileName);
    }
</script>

</body>
</html>
